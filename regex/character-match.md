# 正则表达式字符匹配

**正则表达式是匹配模式，要么匹配字符，要么匹配位置。请记住这句话。**

然而关于正则如何匹配字符的学习，大部分人都觉得这块比较杂乱。毕竟元字符太多了，看起来没有系统性，不好记。本章就解决这个问题。

内容包括：

- 两种模糊匹配
- 字符组
- 量词
- 分支结构
- 案例分析

## 两种模糊匹配

如果正则只有精确匹配是没多大意义的，比如 `/hello/`，也只能匹配字符串中的 `"hello"` 这个子串。

```javascript
var regex = /hello/;
console.log(regex.test("hello"));
// => true
```

正则表达式之所以强大，是因为其能实现模糊匹配。

而模糊匹配，有两个方向上的“模糊”：横向模糊和纵向模糊。

### 横向模糊匹配

横向模糊指的是，一个正则可匹配的字符串的长度不是固定的，可以是多种情况的。

其实现的方式是使用量词。譬如 `{m,n}`，表示连续出现最少 m 次，最多 n 次。

比如正则 `/ab{2,5}c/` 表示匹配这样一个字符串：第一个字符是 `"a"`，接下来是 2 到 5 个字符 `"b"`，最后是字符 `"c"`。

其可视化形式如下：

![r.1.1.png](/.gitbook/assets/r.1.1.png)

测试如下：

```javascript
var regex = /ab{2,5}c/g;
var string = "abc abbc abbbc abbbbc abbbbbc abbbbbbc";
console.log( string.match(regex) );
// => ["abbc", "abbbc", "abbbbc", "abbbbbc"]
```

> NOTE： 案例中用的正则是 `/ab{2,5}c/g`，其中 `g` 是正则的一个修饰符。表示全局匹配，即，在目标字符串中按顺序找到满足匹配模式的所有子串，强调的是“所有”，而不只是“第一个”。`g` 是单词 global 的首字母。

### 纵向模糊匹配

纵向模糊指的是，一个正则匹配的字符串，具体到某一位字符时，它可以不是某个确定的字符，可以有多种可能。

其实现的方式是使用字符组。譬如 `[abc]`，表示该字符是可以字符 "a"、"b"、"c" 中的任何一个。

比如 `/a[123]b/` 可以匹配如下三种字符串： "a1b"、"a2b"、"a3b"。

其可视化形式如下：

![r.1.1.png](/.gitbook/assets/r.1.2.png)

测试如下：

```javascript
var regex = /a[123]b/g;
var string = "a0b a1b a2b a3b a4b";
console.log( string.match(regex) );
// => ["a1b", "a2b", "a3b"]
```

以上就是本章讲的主体内容，只要掌握横向和纵向模糊匹配，就能解决很大部分正则匹配问题。

接下来，我们将具体展开来说。

## 字符组

需要强调的是，虽叫字符组（字符类），但只是其中一个字符。

例如 `[abc]`，表示匹配一个字符，它可以是 "a"、"b"、"c" 之一。

### 范围表示法

如果字符组里的字符特别多的话，怎么办？可以使用范围表示法。

比如 `[123456abcdefGHIJKLM]`，可以写成 `[1-6a-fG-M]`。用连字符 `-` 来省略和简写。

因为连字符有特殊用途，那么要匹配 "a"、"-"、"z" 这三者中任意一个字符，该怎么做呢？

不能写成 `[a-z]`，因为其表示小写字符中的任何一个字符。

可以写成如下的方式：`[-az]` 或 `[az-]` 或 `[a\-z]`。

即要么放在开头，要么放在结尾，要么转义。总之不会让引擎认为是范围表示法就行了。

### 排除字符组

纵向模糊匹配，还有一种情形就是，某位字符可以是任何东西，但就不能是 "a"、"b"、"c"。

此时就是排除字符组（反义字符组）的概念。例如 `[^abc]`，表示是一个除 "a"、"b"、"c"之外的任意一个字符。字符组的第一位放 `^`（脱字符），表示求反的概念。当然，也有相应的范围表示法。

### 常见的简写形式

有了字符组的概念后，一些常见的符号我们也就理解了。因为它们都是系统自带的简写形式。

| 字符组 | 具体含义 |
| :--- | :--- |
| `\d` | 表示 `[0-9]`。表示是一位数字。<br>记忆方式：其英文是 digit（数字）。 |
| `\D` | 表示 `[^0-9]`。表示除数字外的任意字符。 |
| `\w` | 表示 `[0-9a-zA-Z_]`。表示数字、大小写字母和下划线。<br> 记忆方式：w 是 word 的简写，也称单词字符。
|
| `\W` | 表示 `[^0-9a-zA-Z_]`。非单词字符。 |
| `\s` | 表示 `[ \t\v\n\r\f]`。表示空白符，包括空格、水平制表符、垂直制表符、换行符、回车符、换页符。<br>记忆方式：s 是 space 的首字母，空白符的单词是 white space。|
| `\S` | 表示 `[^ \t\v\n\r\f]`。 非空白符。 |
| `.` | 表示 `[^\n\r\u2028\u2029]`。通配符，表示几乎任意字符。换行符、回车符、行分隔符和段分隔符除外。<br>记忆方式：想想省略号 … 中的每个点，都可以理解成占位符，表示任何类似的东西。 |

如果要匹配任意字符怎么办？可以使用 `[\d\D]`、`[\w\W]`、`[\s\S]` 和 `[^]` 中任何的一个。

以上各字符组对应的可视化形式是：

![r.1.1.png](/.gitbook/assets/r.1.3.png)

## 量词

## 分支结构

## 案例分析
